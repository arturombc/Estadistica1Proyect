---
title: <center><span>Análisis de usuarios de una empresa de telefonía movil.</span></center>
format: 
  html:
    toc: true
    toc-depth: 3
    toc-title: Contenido
    anchor_sections: TRUE # Mostrar anclaje de la sección al pasar el mouse
    code_download: TRUE # Permite a los lectores descargar el qmd
    code_folding: TRUE # Permite a los lectores cambiar a none, hide or show
    fig_caption: TRUE # Las imagenes se renderizan con caption
    theme: journal  #superhero cyborg, darkly, journal, vapor. Library "bslib"
    # runtime: shiny # sirve para que la librería shiny interactiva funcione. library("shiny")
    number-sections: true
    embed-resources: true
    author-title: Autores
author: 
  - Arturo Barrantes Chuquimia
  - .
  - .
  - .
  - .
editor: visual
---

# [**Introducción**]{style="color:#1FB0DB"}

## **Relevancia**

En el contexto empresarial, analizar una base de datos con información de los clientes puede llegar a ser crucial para el crecimiento de una empresa; así como del uso correcto de los recursos.\
A lo largo de este trabajo, se analizará el comportamiento de los clientes de una empresa de telefonía móvil. El objetivo será encontrar *insights* con el fin de optimizar nuestros esfuerzos hacia el crecimiento empresarial.

## **Objetivos**

1.  Encontrar una relación entre el equipo(teléfono) y el consumo de datos del usuario.
2.  Analizar las llamadas que realizan y reciben los usuarios
3.  Analizar razones por las que los usuarios no pagan las facturas.

## **Planificación**

# **Datos**

## **Población objetivo**

## **Recolección**

## **Variables**

| VARIABLE           | CLASE        | TIPO     | RESTRICCION               | DESCRIPCCION                                                                  |
|--------------|--------------|--------------|--------------|-----------------|
| PERIODO            | Categórica   | Ordinal  | Alternativas consideradas | Periodo de la información                                                     |
| EQUIPO_TEC         | Categórica   | Ordinal  | Alternativas consideradas | Tecnología del chip                                                           |
| EQUIPO_MARCA       | Categórica   | Nominal  | Alternativas consideradas | Marca del equipo en el periodo                                                |
| EQUIPO_MODELO      | Categórica   | Nominal  | Alternativas consideradas | Modelo del dispositivo                                                        |
| EQUIPO_OS          | Categórica   | Nominal  | Alternativas consideradas | Tipo de sistema operativo                                                     |
| TRAF_DATOS_4G      | Cuantitativa | Continua | Numero positivo           | Tráfico de datos 4G en Mb consumidos durante el periodo                       |
| TRAF_DATOS_3G      | Cuantitativa | Continua | Numero positivo           | Tráfico de datos 3G en Mb consumidos durante el periodo                       |
| TRAF_DATOS_2G      | Cuantitativa | Continua | Numero positivo           | Tráfico de datos 2G en Mb consumidos durante el periodo                       |
| TRAF_DATOS_TOTAL   | Cuantitativa | Continua | Numero positivo           | Tráfico de datos Total en Mb consumidos durante el periodo                    |
| VALORRENTAMENSUAL  | Categórica   | Ordinal  | Alternativas consideradas | El cargo fijo mensual de su plan (Lo que debe pagar por el servicio). Sin IGV |
| DEPARTAMENTO       | Categórica   | Nominal  | Departamentos del Perú    | Departamento de ubicación del cliente                                         |
| AIRTIME_IN_TOT     | Cuantitativa | Continua | Numero positivo           | Tiempo total llamadas recibidas durante el periodo, en minutos                |
| CALLS_IN_TOT       | Cuantitativa | Discreta | Numero entero y positivo  | Cantidad de llamadas recibidas durante el periodo                             |
| DAYS_IN_VOICE_TOT  | Cuantitativa | Discreta | Numero entero y positivo  | Cantidad de días que recibieron llamadas durante el periodo                   |
| AIRTIME_OUT_TOT    | Cuantitativa | Continua | Numero positivo           | Tiempo total llamadas realizadas durante el periodo, en minutos               |
| CALLS_OUT_TOT      | Cuantitativa | Discreta | Numero entero y positivo  | Cantidad de llamadas realizadas durante el periodo                            |
| DAYS_OUT_VOICE_TOT | Cuantitativa | Discreta | Numero entero y positivo  | Cantidad de días que realizó llamadas durante el periodo                      |
| MONTO_DEUDA        | Cuantitativa | Continua | Numero positivo           | Deuda en soles durante el periodo                                             |
|                    |              |          |                           |                                                                               |
|                    |              |          |                           |                                                                               |
|                    |              |          |                           |                                                                               |
|                    |              |          |                           |                                                                               |
|                    |              |          |                           |                                                                               |
|                    |              |          |                           |                                                                               |

## **Limpieza**

###### Librerías

```{r}
if (!require(readr)){install.packages(readr);library(readr)}
if (!require(dplyr)){install.packages(dplyr);library(dplyr)}
if (!require(ggplot2)){install.packages(ggplot2);library(ggplot2)}
```

```{r}
obj2<-read_csv("obj2.csv")
obj2
```

```{r}
obj3<-read_csv("obj3.csv")
obj3
```

```{r, setup, include=FALSE}
# Se invocan las librerías, se setean los temas, etc.
knitr::opts_chunk$set(
  comment = '', fig.width = 6, fig.height = 6 # comment = "" hace que no se vean los comentarios
)
```

Ahora leeré los txt

```{r, warning=FALSE, message=FALSE}
DF1 <- read_delim("data/EQUIPOS.txt","|")
DF2 <- read_delim("data/CONSULTAS_PORTA.txt","|")
DF3 <- read_delim("data/FACTURACION.txt","|")
DF4 <- read_delim("data/INDICADORES_RED.txt","|")
DF5 <- read_delim("data/INTENTOS_PORTA.txt","|")
DF6 <- read_delim("data/PLANTA.txt","|")
DF7 <- read_delim("data/TARGET.txt","|")
DF8 <- read_delim("data/TRAFICO_DATOS.txt","|")
DF9 <- read_delim("data/TRAFICOVOZSMS.txt","|")
```

## **Limpieza de datos**

```{r}
DF = merge(DF1,DF8, by = "ID1")
ncol(DF1)
ncol(DF8)
nrow(DF)
ncol(DF)
round(sum(is.na(DF))/(nrow(DF)*ncol(DF))*100 , digits = 2)


DF <- subset(DF, select = -TRAF_DATOS_3G_NO_COSITE)
DF <- subset(DF, select = -TRAF_DATOS_3G_COSITE)
names(DF)

colSums(is.na(DF))
DFF <- na.omit(DF)
nrow(DFF)

DFFFF <- DF6[, c("ID1", "PERIODO", "ValorRentaMensual", "DEPARTAMENTO_XDR", "DEPARTAMENTO_CDR")]
obj1 <- na.omit(merge(DFF,DFFFF, by="ID1"))
nrow(obj1)

obj1
write_csv(obj1, "obj1.csv")
# En esta tabla esta: EQUIPOS, TRAFICO_DATOS y PLANTA. Algunos valores de periodo se repiten, averiguar que hacer con eso

```

```{r}
DF_ = merge(DF1,DF9, by = "ID1")
names(DF_)

DFF_ <- na.omit(DF_)

round(sum(is.na(DFF_))/(nrow(DFF_)*ncol(DFF_))*100 , digits = 2)

write_csv(DFF_, "obj2.csv")
```

```{r}

length(unique(DF3$ID2))
nrow(DF3)
D <- merge(DF3,DF7, by="ID2")
nrow(D)
D <- subset(D, select=-TARGET_PERM)
D <- subset(D, select=-NUM_BOLETA)
D <- na.omit(D)
nrow(D)
# D <- subset(D, select=-PERIODO) # Ver que hacer con el periodo
write_csv(D,"obj3.csv")
```

**Eliminación de variables:**

```{r}
#obj1 <- subset(obj1, select = -DEPARTAMENTO_CDR)
#obj1 <- subset(obj1, select = -PERIODO.x)

#DFF_ <- subset(DFF_, select = -AIRTIME_IN_ON)
#DFF_ <- subset(DFF_, select = -AIRTIME_IN_OFF)
#DFF_ <- subset(DFF_, select = -AIRTIME_IN_WEEK)
#DFF_ <- subset(DFF_, select = -AIRTIME_IN_WEEKD)
DFF_ <- subset(DFF_, select = -CALLS_IN_ON)
DFF_ <- subset(DFF_, select = -CALLS_IN_OFF)
DFF_ <- subset(DFF_, select = -CALLS_IN_WEEK)
DFF_ <- subset(DFF_, select = -CALLS_IN_WEEKD)
DFF_ <- subset(DFF_, select = -ORIG_VOICE_ON)
DFF_ <- subset(DFF_, select = -ORIG_VOICE_OFF)
DFF_ <- subset(DFF_, select = -DAYS_IN_VOICE_ON)
DFF_ <- subset(DFF_, select = -DAYS_IN_VOICE_OFF)
DFF_ <- subset(DFF_, select = -AIRTIME_OUT_ON)
DFF_ <- subset(DFF_, select = -AIRTIME_OUT_OFF)
DFF_ <- subset(DFF_, select = -AIRTIME_OUT_WEEK)
DFF_ <- subset(DFF_, select = -AIRTIME_OUT_WEEKD)
DFF_ <- subset(DFF_, select = -CALLS_OUT_ON)
DFF_ <- subset(DFF_, select = -CALLS_OUT_OFF)
DFF_ <- subset(DFF_, select = -CALLS_OUT_WEEK)
DFF_ <- subset(DFF_, select = -CALLS_OUT_WEEKD)
DFF_ <- subset(DFF_, select = -DEST_VOICE_ON)
DFF_ <- subset(DFF_, select = -DEST_VOICE_OFF)
DFF_ <- subset(DFF_, select = -DAYS_OUT_VOICE_ON)
DFF_ <- subset(DFF_, select = -DAYS_OUT_VOICE_OFF)
DFF_ <- subset(DFF_, select = -CONT_ON)
DFF_ <- subset(DFF_, select = -CONT_OFF)
DFF_ <- subset(DFF_, select = -TOP_CONT_ON_5)
DFF_ <- subset(DFF_, select = -TOP_CONT_OFF_5)
DFF_ <- subset(DFF_, select = -PERIODO.x) 


```
